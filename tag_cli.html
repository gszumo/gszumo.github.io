<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="main.css" type="text/css" />
<link rel="stylesheet" href="blog.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="Subscribe to this page..." href="feed.rss" />
<title>Gregg Szumowski &mdash; Posts tagged "cli"</title>
<meta name='twitter:card' content='summary' />
<meta name='twitter:site' content='@gszumo' />
<meta name='twitter:title' content='Gregg Szumowski &mdash; Posts tagged "cli"' />
<meta name='twitter:description' content=" Sort Directory by File Size   April 13, 2020 &mdash;  Gregg Szumowski    To sort files in a directory and to list them by the biggest file first:  $ du -a | sort -n -r | more          Comments? Tweet  &nbsp;  Running Docker on Fedora 26 for the Firs" />
</head><body>
<div id="divbodyholder">
<div class="headerholder"><div class="header">
<div id="title">
<h1 class="nomargin"><a class="ablack" href="http://gszumo.github.io//index.html">Gregg Szumowski</a></h1>
<div id="description">Tips & Tricks that I've Encountered Over the Years...</div>
</div></div></div>
<div id="divbody"><div class="content">
<h3><a class="ablack" href="sort-directory-by-file-size11284.html">
Sort Directory by File Size
</a></h3>
<!-- bashblog_timestamp: #202004132239.32# -->
<div class="subtitle">April 13, 2020 &mdash; 
Gregg Szumowski
</div>
<!-- text begin -->

<p>To sort files in a directory and to list them by the biggest file first:<br>
<code>
$ du -a | sort -n -r | more
</code></p>

<p>Tags: <a href='tag_cli.html'>cli</a></p>






<!-- text end -->
<p id='twitter'><a href='http://twitter.com/intent/tweet?url=http://gszumo.github.io//sort-directory-by-file-size11284.html&text=&lt;Type your comment here but please leave the URL so that other people can follow the comments&gt;&via=gszumo'>Comments? Tweet</a> 
<a href='https://twitter.com/search?q=http://gszumo.github.io//sort-directory-by-file-size11284.html'><span id='count-7257'></span></a>&nbsp;</p>
<h3><a class="ablack" href="running-docker-on-fedora-26-for-the-first-time23728.html">
Running Docker on Fedora 26 for the First Time
</a></h3>
<!-- bashblog_timestamp: #202004132237.17# -->
<div class="subtitle">April 13, 2020 &mdash; 
Gregg Szumowski
</div>
<!-- text begin -->

<p>OK, so I want to start using docker on my Fedora laptop: How do we get started? Well, the Fedora Workstation page says that it comes with built-in Docker support so let's see if we can start it up:</p>

<p><code> $ which docker </code><br>
<code>/usr/bin/docker </code><br>
<code> $ docker login </code><br>
<code>/usr/bin/docker: line 13: /usr/bin/docker-latest: No such file or directory </code><br>
<code> $ docker image pull nginx </code><br>
<code>/usr/bin/docker: line 13: /usr/bin/docker-latest: No such file or directory </code><br></p>

<p>OK, so that's weird. Apparently not everything works as advertised. The command line tells me that there's a docker command installed on the laptop by default but it doesn't see to do anything that I want. So, let's try to (re-)install docker to see if that helps:</p>

<p><code> $ sudo dnf install docker </code><br>
<code>[sudo] password for gszumo:  </code><br>
<code>Last metadata expiration check: 0:36:07 ago on Sun 15 Oct 2017 08:11:13 AM EDT. </code><br>
<code>Dependencies resolved. </code><br>
<code>================================================================================ </code><br>
<code> Package                   Arch    Version                       Repository </code><br>
<code>                                                                           Size </code><br>
<code>================================================================================ </code><br>
<code>Installing: </code><br>
<code> docker                    x86<em>64  2:1.13.1-22.gitb5e3294.fc26   updates   20 M </code><br>
<code>Installing dependencies: </code><br>
<code> atomic-registries         x86</em>64  1.18.1-5.fc26                 fedora    45 k </code><br>
<code> container-selinux         noarch  2:2.24-1.fc26                 updates   33 k </code><br>
<code> container-storage-setup   noarch  0.8.0-1.git1d27ecf.fc26       updates   36 k </code><br>
<code> docker-rhel-push-plugin   x86<em>64  2:1.13.1-22.gitb5e3294.fc26   updates  1.6 M </code><br>
<code> libnet                    x86</em>64  1.1.6-12.fc26                 fedora    63 k </code><br>
<code> libyaml                   x86<em>64  0.1.7-2.fc26                  fedora    57 k </code><br>
<code> oci-umount                x86</em>64  2:2.0.0-2.gitf90b64c.fc26     updates   30 k </code><br>
<code> python-rhsm-certificates  x86<em>64  1.20.1-1.fc26                 updates   44 k </code><br>
<code> skopeo-containers         x86</em>64  0.1.23-6.git1bbd87f.fc26      updates   13 k </code><br>
<code>Installing weak dependencies: </code><br>
<code> criu                      x86<em>64  3.5-1.fc26                    updates  450 k </code><br>
<code> oci-register-machine      x86</em>64  0-5.11.gitcd1e331.fc26        updates  1.0 M </code><br>
<code> oci-systemd-hook          x86<em>64  1:0.1.13-1.gitafe4b4a.fc26    updates   35 k </code><br>
<code> </code><br>
<code>Transaction Summary </code><br>
<code>================================================================================ </code><br>
<code>Install  13 Packages </code><br>
<code> </code><br>
<code>Total download size: 23 M </code><br>
<code>Installed size: 78 M </code><br>
<code>Is this ok [y/N]: y </code><br>
<code>Downloading Packages: </code><br>
<code>(1/13): atomic-registries-1.18.1-5.fc26.x86</em>64.rpm             179 kB/s |  45 kB     00:00     </code><br>
<code>(2/13): libyaml-0.1.7-2.fc26.x86<em>64.rpm                        209 kB/s |  57 kB     00:00     </code><br>
<code>(3/13): docker-rhel-push-plugin-1.13.1-22.gitb5e3294.fc26.x86</em> 2.1 MB/s | 1.6 MB     00:00     </code><br>
<code>(4/13): container-selinux-2.24-1.fc26.noarch.rpm               129 kB/s |  33 kB     00:00     </code><br>
<code>(5/13): container-storage-setup-0.8.0-1.git1d27ecf.fc26.noarch 812 kB/s |  36 kB     00:00     </code><br>
<code>(6/13): oci-umount-2.0.0-2.gitf90b64c.fc26.x86<em>64.rpm          527 kB/s |  30 kB     00:00     </code><br>
<code>(7/13): python-rhsm-certificates-1.20.1-1.fc26.x86</em>64.rpm      730 kB/s |  44 kB     00:00     </code><br>
<code>(8/13): skopeo-containers-0.1.23-6.git1bbd87f.fc26.x86<em>64.rpm  295 kB/s |  13 kB     00:00     </code><br>
<code>(9/13): criu-3.5-1.fc26.x86</em>64.rpm                             1.9 MB/s | 450 kB     00:00     </code><br>
<code>(10/13): oci-systemd-hook-0.1.13-1.gitafe4b4a.fc26.x86<em>64.rpm  648 kB/s |  35 kB     00:00     </code><br>
<code>(11/13): libnet-1.1.6-12.fc26.x86</em>64.rpm                       165 kB/s |  63 kB     00:00     </code><br>
<code>(12/13): oci-register-machine-0-5.11.gitcd1e331.fc26.x86<em>64.rp 1.9 MB/s | 1.0 MB     00:00     </code><br>
<code>(13/13): docker-1.13.1-22.gitb5e3294.fc26.x86</em>64.rpm           3.0 MB/s |  20 MB     00:06     </code><br>
<code>----------------------------------------------------------------------------------------------- </code><br>
<code>Total                                                          3.0 MB/s |  23 MB     00:07      </code><br>
<code>Running transaction check </code><br>
<code>Transaction check succeeded. </code><br>
<code>Running transaction test </code><br>
<code>Transaction test succeeded. </code><br>
<code>Running transaction </code><br>
<code> ... </code><br>
<code> ... </code><br>
<code> ... Lots of installation stuff here ... </code><br>
<code> ... </code><br>
<code> ... </code><br>
<code>Complete! </code><br></p>

<p>So now lets fire it up and see what happens:</p>

<p><code> $ sudo systemctl start docker </code><br>
<code> $ sudo docker run hello-world </code><br>
<code>Unable to find image 'hello-world:latest' locally </code><br>
<code>Trying to pull repository registry.fedoraproject.org/hello-world ...  </code><br>
<code>Trying to pull repository registry.access.redhat.com/hello-world ...  </code><br>
<code>Trying to pull repository docker.io/library/hello-world ...  </code><br>
<code>sha256:07d5f7800dfe37b8c2196c7b1c524c33808ce2e0f74e7aa00e603295ca9a0972: Pulling from docker.io/library/hello-world </code><br>
<code>5b0f327be733: Pull complete  </code><br>
<code>Digest: sha256:07d5f7800dfe37b8c2196c7b1c524c33808ce2e0f74e7aa00e603295ca9a0972 </code><br>
<code>Status: Downloaded newer image for docker.io/hello-world:latest </code><br>
<code> </code><br>
<code>Hello from Docker! </code><br>
<code>This message shows that your installation appears to be working correctly. </code><br>
<code> </code><br>
<code>To generate this message, Docker took the following steps: </code><br>
<code> 1. The Docker client contacted the Docker daemon. </code><br>
<code> 2. The Docker daemon pulled the "hello-world" image from the Docker Hub. </code><br>
<code> 3. The Docker daemon created a new container from that image which runs the </code><br>
<code>    executable that produces the output you are currently reading. </code><br>
<code> 4. The Docker daemon streamed that output to the Docker client, which sent it </code><br>
<code>    to your terminal. </code><br>
<code> </code><br>
<code>To try something more ambitious, you can run an Ubuntu container with: </code><br>
<code> $ docker run -it ubuntu bash </code><br>
<code> </code><br>
<code>Share images, automate workflows, and more with a free Docker ID: </code><br>
<code> https://cloud.docker.com/ </code><br>
<code> </code><br>
<code>For more examples and ideas, visit: </code><br>
<code> https://docs.docker.com/engine/userguide/ </code><br>
<code> </code><br>
<code> </code><br>
Bingo, we're good to go. Let's setup the daemon so that it survives a reboot:</p>

<p><code> $ sudo systemctl enable docker </code><br>
<code>[sudo] password for gszumo:  </code><br>
<code>Created symlink /etc/systemd/system/multi-user.target.wants/docker.service -> /usr/lib/systemd/system/docker.service. </code><br>
<code> $  </code><br></p>

<p>Now we're ready to rock 'n roll!</p>

<p>Tags: <a href='tag_cli.html'>cli</a>, <a href='tag_linux.html'>linux</a></p>






<!-- text end -->
<p id='twitter'><a href='http://twitter.com/intent/tweet?url=http://gszumo.github.io//running-docker-on-fedora-26-for-the-first-time23728.html&text=&lt;Type your comment here but please leave the URL so that other people can follow the comments&gt;&via=gszumo'>Comments? Tweet</a> 
<a href='https://twitter.com/search?q=http://gszumo.github.io//running-docker-on-fedora-26-for-the-first-time23728.html'><span id='count-25083'></span></a>&nbsp;</p>
<h3><a class="ablack" href="removing-m-characters-from-multiple-files.html">
Removing ^M Characters From Multiple Files
</a></h3>
<!-- bashblog_timestamp: #202004132235.20# -->
<div class="subtitle">April 13, 2020 &mdash; 
Gregg Szumowski
</div>
<!-- text begin -->

<p>In my day job I find that I frequently need to remove those pesky '^M' line endings from text files that are transferred from one system to the other. Most of the time it is just one file that needs to be fixed so going into vi and typing</p>

<p><code> :%s/^M//g </code><br></p>

<p>solves the problem, but on occasion I might be confronted with performing this process on multiple files and sometimes recursively through many subdirectories. When that happens it becomes necessary to bring out the "big guns" and do:</p>

<p><code> $ for file in $(find /path/to/dir -type f); do </code><br>
<code>       tr -d '\r' <$file >temp.$$ &amp;&amp; mv temp.$$ $file </code><br>
<code>   done </code><br>
<code> $ </code><br></p>

<p>(BTW, to generate a ^M character using the PuTTY emulator is easy. Just press CTRL-^ followed by CTRL-M)</p>

<p>Of course, in Linux, UNIX and AIX shells there are many ways to skin a cat and this is just one of many possible solutions. This solution was found on <a href="https://dailyvim.blogspot.com">a Daily Vim Blogspot site</a> which has more very interesting tips &amp; tutorials.</p>

<p>Tags: <a href='tag_cli.html'>cli</a></p>






<!-- text end -->
<p id='twitter'><a href='http://twitter.com/intent/tweet?url=http://gszumo.github.io//removing-m-characters-from-multiple-files.html&text=&lt;Type your comment here but please leave the URL so that other people can follow the comments&gt;&via=gszumo'>Comments? Tweet</a> 
<a href='https://twitter.com/search?q=http://gszumo.github.io//removing-m-characters-from-multiple-files.html'><span id='count-7176'></span></a>&nbsp;</p>
<h3><a class="ablack" href="learning-the-command-line32228.html">
Learning the Command Line
</a></h3>
<!-- bashblog_timestamp: #202004132233.20# -->
<div class="subtitle">April 13, 2020 &mdash; 
Gregg Szumowski
</div>
<!-- text begin -->

<p>A good beginner's article on using the command line to manage your files can be found 
<a href="http://www.linux.com/learn/tutorials/842251-must-know-linux-commands-for-new-users">here</a></p>

<p>Tags: <a href='tag_cli.html'>cli</a></p>






<!-- text end -->
<p id='twitter'><a href='http://twitter.com/intent/tweet?url=http://gszumo.github.io//learning-the-command-line32228.html&text=&lt;Type your comment here but please leave the URL so that other people can follow the comments&gt;&via=gszumo'>Comments? Tweet</a> 
<a href='https://twitter.com/search?q=http://gszumo.github.io//learning-the-command-line32228.html'><span id='count-30090'></span></a>&nbsp;</p>
<h3><a class="ablack" href="getting-rid-of-m-line-endings-in-a-text-file.html">
Getting Rid of ^M Line Endings in a Text File
</a></h3>
<!-- bashblog_timestamp: #202004132229.08# -->
<div class="subtitle">April 13, 2020 &mdash; 
Gregg Szumowski
</div>
<!-- text begin -->

<p>If you have a text file that has funny looking ^M characters at the end of each line, in most cases, you have to get rid of them before they can be used. This is especially the case when you've copied or transferred a file from a Windows-based system to a *nix-based one. If these files are shell scripts meant to run on the *nix-based system they more often than not won't work. There are various solutions to this problem.</p>

<p>First, let's create two text files: one with ^M line endings and one without:</p>

<p><code> $ for line in 1 2 3 4 5; do echo "This is line ${line}^M" >>file1.txt; done </code><br>
<code> $ for line in 1 2 3 4 5; do echo "This is line ${line}" >>file2.txt; done </code><br></p>

<p>Now let's see what's different between these two text files:</p>

<p><code> $ ls -l </code><br>
<code> total 8 </code><br>
<code> -rw-rw-r--. 1 gszumo gszumo 80 Oct 29 17:43 file1.txt </code><br>
<code> -rw-rw-r--. 1 gszumo gszumo 75 Oct 29 17:44 file2.txt </code><br></p>

<p><code> $ file file1.txt </code><br>
<code> file1.txt: ASCII text, with CRLF line terminators </code><br></p>

<p><code> $ file file2.txt </code><br>
<code> file2.txt: ASCII text </code><br></p>

<p><code> $ diff file1.txt file2.txt </code><br>
<code> 1,5c1,5 </code><br>
<code> &lt; This is line 1 </code><br>
<code> &lt; This is line 2 </code><br>
<code> &lt; This is line 3 </code><br>
<code> &lt; This is line 4 </code><br>
<code> &lt; This is line 5 </code><br>
<code> --- </code><br>
<code> > This is line 1 </code><br>
<code> > This is line 2 </code><br>
<code> > This is line 3 </code><br>
<code> > This is line 4 </code><br>
<code> > This is line 5 </code><br>
<code> $ </code><br></p>

<p>What does this tell us?</p>

<ul>
<li>The ls command tells us the file sizes are different even though the visible text is the same.</li>
<li>The file command tells us that both files are ASCII text  but file1.txt has CRLF line terminators, and</li>
<li>The diff command tells us that each line is indeed showing us that it's different.</li>
</ul>

<p>So, how do we fix this?</p>

<p>My favorite solution is to use vi or vim interactively. There are 2 easy ways to get rid of the ^M from a single file using vim:</p>

<ol>
<li>Enter the command:
<br><code> :%s/^M//g </code><br>
on the vim command line then save the file, or</li>
<li>Enter the command:
<br><code> :fileformat=unix </code><br>
on the vim command line and save the file.</li>
</ol>

<p>However, if you have a whole directory or directory tree full of these kinds of files using vim on each one individually will become quite tedious. For this you need the scripting capability of the command line!</p>

<p>The 'tr' command is one quick way of getting rid of them using the Linux or macOS command line:</p>

<p><code> cat somefile | tr -d '^M' >outputfile </code><br></p>

<p>We can use this as a template in order to determine whether or not the file needs to be updated:</p>

<p><code> for i in * </code><br>
<code> do </code><br>
<code>   string=$(file ${i}) </code><br>
<code>   test "${string#*'CRLF'}" != "$string" &amp;&amp; echo "CRLF found in ${i}" </code><br>
<code> done </code><br></p>

<p>If the 'echo' part of this snippet only gets called when the first part of the test is true, so then we know that the file has '^M' line endings. We have to turn the second part of the test into a script that will massage the file to remove the line endings. Here's a bash snippet that will put the two together and do the job:</p>

<p><code> for i in * </code><br>
<code> do </code><br>
<code>   string=$(file ${i}) </code><br>
<code>   if [ "${string#*'CRLF'}" != "$string" ];then </code><br>
<code>     cp ${i} ${i}.bak </code><br>
<code>     cat ${i}.bak|tr -d '^M' >${i} </code><br>
<code>     rm ${i}.bak </code><br>
<code>   fi </code><br>
<code> done </code><br></p>

<p>This is a bare-bones piece of code which doesn't do any error checking, which should be added in the event that the user running this script doesn't have the necessary permissions to copy, write or remove files that match the test.</p>

<p>Remember, in order to create a '^M' character in the terminal hold down the CTRL key while  typing vm.</p>

<p>You can also use 'ex' to replace a string in a file using:</p>

<p><code> ex -s -c '%s/old-str/new-str/g|x' filename.txt </code><br></p>

<p>Alternately, we can use sed to do the same thing. At the command line you can replace any string in a file dynamically by entering:</p>

<p><code> sed -i 's/old-str/new-str/' filename.txt </code><br></p>

<p>So to remove the ^M charaters just do:</p>

<p><code> sed -i 's/^M//' filename.txt </code><br></p>

<p>to remove the ^M characters. You can use the same for/do/done loop structure as mentioned above to iterate over multiple files:</p>

<p><code> for i in *.txt </code><br>
<code> do </code><br>
<code>   sed -i 's/^M//' ${i} </code><br>
<code> done </code><br></p>

<p>'Nuff said.</p>

<p>Tags: <a href='tag_cli.html'>cli</a></p>






<!-- text end -->
<p id='twitter'><a href='http://twitter.com/intent/tweet?url=http://gszumo.github.io//getting-rid-of-m-line-endings-in-a-text-file.html&text=&lt;Type your comment here but please leave the URL so that other people can follow the comments&gt;&via=gszumo'>Comments? Tweet</a> 
<a href='https://twitter.com/search?q=http://gszumo.github.io//getting-rid-of-m-line-endings-in-a-text-file.html'><span id='count-997'></span></a>&nbsp;</p>
<h3><a class="ablack" href="get-the-hash-of-a-file-on-different-operating-systems.html">
Get the Hash of a File on Different Operating Systems
</a></h3>
<!-- bashblog_timestamp: #202004132225.54# -->
<div class="subtitle">April 13, 2020 &mdash; 
Gregg Szumowski
</div>
<!-- text begin -->

<p>Sometimes you just need to hash something. Here are some command lines to do just that.</p>

<p>Windows PowerShell:</p>

<p><code> Get-FileHash C:\path\to\file.iso -Algorithm [MD5|SHA1|SHA256|SHA384|SHA512|MACTripleDES|RIPEMD160] </code><br></p>

<p>(SHA256 is the default if the parameter is omitted) </p>

<p>Linux: </p>

<p><code> md5sum /path/to/file </code><br>
<code> sha1sum /path/to/file </code><br>
<code> sha256sum /path/to/file </code><br></p>

<p>macOS:</p>

<p><code> MD5: md5 /path/to/file </code><br>
<code> SHA1: shasum /path/to/file or shasum -a 1 /path/to/file </code><br>
<code> SHA-256: shasum -a 256 /path/to/file </code><br></p>

<p>Tags: <a href='tag_cli.html'>cli</a></p>






<!-- text end -->
<p id='twitter'><a href='http://twitter.com/intent/tweet?url=http://gszumo.github.io//get-the-hash-of-a-file-on-different-operating-systems.html&text=&lt;Type your comment here but please leave the URL so that other people can follow the comments&gt;&via=gszumo'>Comments? Tweet</a> 
<a href='https://twitter.com/search?q=http://gszumo.github.io//get-the-hash-of-a-file-on-different-operating-systems.html'><span id='count-29300'></span></a>&nbsp;</p>
<h3><a class="ablack" href="count-occurences-of-a-character-in-a-string.html">
Count Occurences of a Character in a String
</a></h3>
<!-- bashblog_timestamp: #202004132221.34# -->
<div class="subtitle">April 13, 2020 &mdash; 
Gregg Szumowski
</div>
<!-- text begin -->

<p>Sometimes I need to know how many times a specific character occurs in a string. The best tool to use for something like that is AWK. Let's say we're looking for the count of commas in a string:</p>

<p><code> string="text,text,text,text" </code><br>
<code>  char="," </code><br>
<code>  echo "${string}" | awk -F"${char}" '{print NF-1}' </code><br></p>

<p>Tags: <a href='tag_cli.html'>cli</a></p>






<!-- text end -->
<p id='twitter'><a href='http://twitter.com/intent/tweet?url=http://gszumo.github.io//count-occurences-of-a-character-in-a-string.html&text=&lt;Type your comment here but please leave the URL so that other people can follow the comments&gt;&via=gszumo'>Comments? Tweet</a> 
<a href='https://twitter.com/search?q=http://gszumo.github.io//count-occurences-of-a-character-in-a-string.html'><span id='count-250'></span></a>&nbsp;</p>
<h3><a class="ablack" href="copy-entire-directory-structure-using-tar19229.html">
Copy Entire Directory Structure Using Tar
</a></h3>
<!-- bashblog_timestamp: #202004132219.14# -->
<div class="subtitle">April 13, 2020 &mdash; 
Gregg Szumowski
</div>
<!-- text begin -->

<p>Sometimes you need to copy an entire directory structure to another location on the command line. Here is a quick way to do it using the tar command:</p>

<p><code> tar cf - * | ( cd /target; tar xfp -) </code><br></p>

<p>Tags: <a href='tag_cli.html'>cli</a></p>






<!-- text end -->
<p id='twitter'><a href='http://twitter.com/intent/tweet?url=http://gszumo.github.io//copy-entire-directory-structure-using-tar19229.html&text=&lt;Type your comment here but please leave the URL so that other people can follow the comments&gt;&via=gszumo'>Comments? Tweet</a> 
<a href='https://twitter.com/search?q=http://gszumo.github.io//copy-entire-directory-structure-using-tar19229.html'><span id='count-31758'></span></a>&nbsp;</p>
</div>
<div id="footer">CC by-nc-nd <a href="http://twitter.com/gszumo">Gregg Szumowski</a> &mdash; <a href="mailto:gszumo&#64;gmail&#46;com">gszumo&#64;gmail&#46;com</a><br/>
Generated with <a href="https://github.com/cfenollosa/bashblog">bashblog</a>, a single bash script to easily create blogs like this one</div>
</div></div>
</body></html>
